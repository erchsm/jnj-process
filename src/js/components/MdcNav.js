import React, {Component} from 'react';
import classNames from "classnames";

import NavItems from "../data/nav-items";
import SpecialtiesItems from "../data/specialties-items";
import MdcLogo from "./MdcLogo";


export default class MdcNav extends Component {

	static propTypes = {
	}


	constructor(props) {
		super(props);

        this.state = {
            isScrolledTop: true,
            takeoverOpen: false,
            indexHovered: 0
        }
	}

    componentDidMount = () => {
        document.addEventListener('scroll', this.handleScroll);
    }

    componentWillUnmount = () => {
        document.removeEventListener('scroll', this.handleScroll);
    }

    handleScroll = (event) => {
        let scrollTop = event.srcElement.body.scrollTop

            // this.setState({
            //     isScrolledTop: scrollTop < 90
            // });
    }

    openTakeover = (event) => {
        this.setState({
            takeoverOpen: true
        });
    }

    setIndexHovered = (event) => {
        this.setState({
            indexHovered: this.getChildIndex(event.target)
        });
    }

    closeTakeover = (event) => {
        // setTimeout(() => {
            this.setState({
                takeoverOpen: false
            });
        // }, 0);
    }

    getChildIndex = (elem) => {
        let i = 0;

        while ((elem = elem.previousSibling) != null) {
          i++;
        }

        return i;
    }

	render() {
        const { isScrolledTop, takeoverOpen, indexHovered } = this.state;


        const classnames = classNames({
            "mdc-nav": true,
            "mdc-nav--takeover": takeoverOpen,
            "mdc-nav--scrolled": !isScrolledTop
        })

        const navItems = NavItems.data.map((item, i) =>
            <li key={i} onMouseOver={(e) => { this.openTakeover(e); this.setIndexHovered(e) }} onMouseOut={this.closeTakeover}>
                <a>{item.name}</a>
            </li>
        );

        const specialtiesItems = SpecialtiesItems.data.map((item, i) =>
            <li key={i} className={ (i == 0) ? "overview-item" : ""}>
                {item.name}
            </li>
        );

        const lineAnimation = {
            transform: 'translate3d(' + 140 * (indexHovered + 0) + 'px, 0, 0)',
            opacity: 1
        }

        return (
            <nav className={classnames}>
                <div className="mdc-nav__topbar">
                    <div className="mdc-nav__left">
                        <MdcLogo/>
                    </div>
                    <div className="mdc-nav__center">
                        <ul>
                            {navItems}
                        </ul>
                    </div>
                    <div className="mdc-nav__right">
                        <i className="iconcss icon-search"></i>
                        <hr/>
                        <svg width={33} height={21}>
                            <g fillRule="nonzero" fill="none">
                              <path
                                d="M32.43 21H.57A.561.561 0 0 1 0 20.447V.553C0 .247.255 0 .569 0h31.862c.314 0 .569.247.569.553v19.894a.561.561 0 0 1-.57.553z"
                                fill="#F5F5F5"
                              />
                              <g fill="#FF4B55">
                                <path d="M32.538 1.63H0V.57C0 .264.251.017.561.017h31.416c.31 0 .56.247.56.552V1.63zM0 6.468h32.538v1.613H0zM0 3.243h32.538v1.613H0zM32.538 11.306H.56A.556.556 0 0 1 0 10.755V9.694h32.538v1.612zM0 16.145h32.538v1.613H0zM31.977 20.983H.56A.556.556 0 0 1 0 20.43v-1.06h32.538v1.06a.556.556 0 0 1-.561.552zM0 12.919h32.538v1.613H0z" />
                              </g>
                              <path
                                d="M14.444 0H.556A.547.547 0 0 0 0 .538v9.924c0 .297.249.538.556.538h13.888c.307 0 .556-.24.556-.538V.538A.547.547 0 0 0 14.444 0z"
                                fill="#41479B"
                              />
                              <g fill="#F5F5F5">
                                <path d="M1.54 1.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05L1.5 1.798l-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM1.54 3.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05L1.5 3.798l-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM1.54 5.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05L1.5 5.798l-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM1.54 7.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05L1.5 7.798l-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM1.54 9.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05L1.5 9.798l-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM3.54 2.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05L3.5 2.798l-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM3.54 4.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05L3.5 4.798l-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM3.54 6.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05L3.5 6.798l-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM3.54 8.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05L3.5 8.798l-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM4.54 1.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05L4.5 1.798l-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM4.54 3.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05L4.5 3.798l-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM4.54 5.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05L4.5 5.798l-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM4.54 7.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05L4.5 7.798l-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM4.54 9.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05L4.5 9.798l-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM6.54 2.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05L6.5 2.798l-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM6.54 4.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05L6.5 4.798l-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM6.54 6.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05L6.5 6.798l-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM6.54 8.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05L6.5 8.798l-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM7.54 1.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05L7.5 1.798l-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM7.54 3.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05L7.5 3.798l-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM7.54 5.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05L7.5 5.798l-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM7.54 7.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05L7.5 7.798l-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM7.54 9.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05L7.5 9.798l-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM9.54 2.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05L9.5 2.798l-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM9.54 4.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05L9.5 4.798l-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM9.54 6.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05L9.5 6.798l-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM9.54 8.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05L9.5 8.798l-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM10.54 1.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05l-.258-.193-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM10.54 3.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05l-.258-.193-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM10.54 5.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05l-.258-.193-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM10.54 7.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05l-.258-.193-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM10.54 9.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05l-.258-.193-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM12.54 2.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05l-.258-.193-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM12.54 4.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05l-.258-.193-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM12.54 6.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05l-.258-.193-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM12.54 8.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05l-.258-.193-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM13.54 1.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05l-.258-.193-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM13.54 3.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05l-.258-.193-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM13.54 5.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05l-.258-.193-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM13.54 7.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05l-.258-.193-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0zM13.54 9.03l.1.315.318.003c.04 0 .058.055.025.08l-.255.197.095.317c.013.04-.032.074-.065.05l-.258-.193-.258.192c-.033.025-.078-.008-.065-.05l.095-.316-.255-.197c-.033-.025-.016-.08.025-.08l.317-.003.1-.314a.042.042 0 0 1 .081 0z" />
                              </g>
                            </g>
                          </svg>
                    </div>
                </div>
                <div className="mdc-nav__hoverbar">
                    <div className="mdc-nav__hoverlines">
                        <div style={ (takeoverOpen) ? lineAnimation : null } className="mdc-nav__hoverline"></div>
                    </div>
                </div>
                    <div className="mdc-nav__hovermain" onMouseOver={ this.openTakeover } onMouseOut={this.closeTakeover}>
                        <div className="mdc-nav__hovermainfeatured">
                            <h3>Featured Content</h3>
                            <ul>
                                <li>Laminoscopy</li>
                                <li>Morter Breadfist</li>
                                <li>Pentultimate Bigness</li>
                                <li>Laminoscopy</li>
                                <li>Morter Breadfist</li>
                                <li>Pentultimate Bigness</li>
                            </ul>
                        </div>
                        <div className="mdc-nav__hovermaincolumn">
                            <ul>
                                { specialtiesItems }
                            </ul>
                        </div>
                    </div>
            </nav>
        );
    }
}